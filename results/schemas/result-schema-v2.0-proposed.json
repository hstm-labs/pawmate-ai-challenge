{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PawMate Benchmark Result File Schema v2.0 (Proposed)",
  "description": "Revised schema treating API and UI as independent implementations",
  "type": "object",
  "required": [
    "schema_version",
    "result_data"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "enum": ["2.0"]
    },
    "result_data": {
      "type": "object",
      "required": [
        "run_identity",
        "implementations",
        "submission"
      ],
      "properties": {
        "run_identity": {
          "type": "object",
          "required": [
            "tool_name",
            "tool_version",
            "run_id",
            "run_number",
            "target_model",
            "api_style",
            "spec_reference",
            "workspace_path",
            "run_environment"
          ],
          "properties": {
            "tool_name": { "type": "string" },
            "tool_version": { "type": "string" },
            "run_id": { "type": "string" },
            "run_number": { "type": "integer", "enum": [1, 2] },
            "target_model": { "type": "string", "enum": ["A", "B"] },
            "api_style": { "type": "string", "enum": ["REST", "GraphQL"] },
            "spec_reference": { "type": "string" },
            "workspace_path": { "type": "string" },
            "run_environment": { "type": "string" }
          }
        },
        "implementations": {
          "type": "object",
          "description": "Independent implementation phases (API and/or UI)",
          "properties": {
            "api": {
              "type": "object",
              "description": "Backend/API implementation",
              "required": [
                "generation_metrics",
                "acceptance",
                "artifacts"
              ],
              "properties": {
                "generation_metrics": {
                  "type": "object",
                  "required": [
                    "llm_model",
                    "start_timestamp",
                    "end_timestamp",
                    "duration_minutes",
                    "clarifications_count",
                    "interventions_count",
                    "reruns_count"
                  ],
                  "properties": {
                    "llm_model": { 
                      "type": "string",
                      "description": "The LLM model used for this implementation (e.g., 'claude-sonnet-4.5', 'gpt-4', 'claude-opus-3')"
                    },
                    "start_timestamp": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$" },
                    "end_timestamp": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$" },
                    "duration_minutes": { "type": "number", "minimum": 0 },
                    "clarifications_count": { "type": "integer", "minimum": 0 },
                    "interventions_count": { "type": "integer", "minimum": 0 },
                    "reruns_count": { "type": "integer", "minimum": 0 }
                  }
                },
                "acceptance": {
                  "type": "object",
                  "required": ["pass_count", "fail_count", "not_run_count", "passrate"],
                  "properties": {
                    "pass_count": { "type": "integer", "minimum": 0 },
                    "fail_count": { "type": "integer", "minimum": 0 },
                    "not_run_count": { "type": "integer", "minimum": 0 },
                    "passrate": { "type": "number", "minimum": 0, "maximum": 1 }
                  }
                },
                "quality_metrics": {
                  "type": "object",
                  "properties": {
                    "determinism_compliance": { "type": "string", "enum": ["Pass", "Fail", "Unknown"] },
                    "overreach_incidents_count": { "type": "integer", "minimum": 0 },
                    "contract_completeness_passrate": { "type": "number", "minimum": 0, "maximum": 1 },
                    "instructions_quality_rating": { "type": "integer", "enum": [100, 70, 40, 0] },
                    "reproducibility_rating": { "type": "string", "enum": ["None", "Minor", "Major", "Unknown"] }
                  }
                },
                "artifacts": {
                  "type": "object",
                  "required": [
                    "contract_artifact_path",
                    "run_instructions_path"
                  ],
                  "properties": {
                    "contract_artifact_path": { "type": "string" },
                    "run_instructions_path": { "type": "string" },
                    "source_code_path": { "type": "string" },
                    "acceptance_checklist_path": { "type": "string" },
                    "acceptance_evidence_path": { "type": "string" },
                    "determinism_evidence_path": { "type": "string" },
                    "overreach_evidence_path": { "type": "string" },
                    "ai_run_report_path": { "type": "string" },
                    "automated_tests_path": { "type": "string" }
                  }
                },
                "scores": {
                  "type": "object",
                  "properties": {
                    "correctness_C": { "type": "number", "minimum": 0, "maximum": 100 },
                    "reproducibility_R": { "type": "number", "minimum": 0, "maximum": 100 },
                    "determinism_D": { "type": "number", "minimum": 0, "maximum": 100 },
                    "effort_E": { "type": "number", "minimum": 0, "maximum": 100 },
                    "speed_S": { "type": "number", "minimum": 0, "maximum": 100 },
                    "contract_docs_K": { "type": "number", "minimum": 0, "maximum": 100 },
                    "penalty_overreach_PO": { "type": "number", "minimum": 0, "maximum": 40 },
                    "overall_score": { "type": "number", "minimum": 0, "maximum": 100 }
                  }
                }
              }
            },
            "ui": {
              "type": "object",
              "description": "Frontend/UI implementation (optional, can be done separately)",
              "required": [
                "generation_metrics",
                "artifacts"
              ],
              "properties": {
                "generation_metrics": {
                  "type": "object",
                  "required": [
                    "llm_model",
                    "start_timestamp",
                    "end_timestamp",
                    "duration_minutes",
                    "clarifications_count",
                    "interventions_count",
                    "reruns_count"
                  ],
                  "properties": {
                    "llm_model": { 
                      "type": "string",
                      "description": "The LLM model used for this implementation (e.g., 'claude-sonnet-4.5', 'gpt-4', 'claude-opus-3')"
                    },
                    "start_timestamp": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$" },
                    "end_timestamp": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$" },
                    "duration_minutes": { "type": "number", "minimum": 0 },
                    "clarifications_count": { "type": "integer", "minimum": 0 },
                    "interventions_count": { "type": "integer", "minimum": 0 },
                    "reruns_count": { "type": "integer", "minimum": 0 },
                    "backend_changes_required": { "type": "boolean" }
                  }
                },
                "quality_metrics": {
                  "type": "object",
                  "properties": {
                    "ui_requirements_compliance": { "type": "string", "enum": ["Pass", "Fail", "Unknown"] },
                    "api_integration_correctness": { "type": "string", "enum": ["Pass", "Fail", "Unknown"] },
                    "consumer_ux_quality": { "type": "integer", "enum": [100, 70, 40, 0] }
                  }
                },
                "artifacts": {
                  "type": "object",
                  "required": [
                    "ui_source_path",
                    "ui_run_summary_path"
                  ],
                  "properties": {
                    "ui_source_path": { "type": "string" },
                    "ui_run_summary_path": { "type": "string" },
                    "run_instructions_path": { "type": "string" }
                  }
                },
                "scores": {
                  "type": "object",
                  "properties": {
                    "ui_correctness": { "type": "number", "minimum": 0, "maximum": 100 },
                    "api_integration_quality": { "type": "number", "minimum": 0, "maximum": 100 },
                    "ux_quality": { "type": "number", "minimum": 0, "maximum": 100 },
                    "speed_S": { "type": "number", "minimum": 0, "maximum": 100 },
                    "overall_ui_score": { "type": "number", "minimum": 0, "maximum": 100 }
                  }
                }
              }
            }
          }
        },
        "submission": {
          "type": "object",
          "required": ["submitted_timestamp", "submitted_by", "submission_method"],
          "properties": {
            "submitted_timestamp": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$" },
            "submitted_by": { "type": "string" },
            "submission_method": { "type": "string", "enum": ["automated", "manual"] },
            "notes": { "type": "string" }
          }
        }
      }
    }
  }
}

